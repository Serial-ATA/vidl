!function(e){function t(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,o){"use strict";var n=localStorage.getItem("lastFormat");n?document.querySelector("button."+n).classList.add("checked"):(n="mp3",document.querySelector("button.mp3").classList.add("checked")),o(1)("focus-within");var i=o(2),c=document.querySelector(".url input");if(document.addEventListener("paste",function(e){document.activeElement&&document.activeElement.classList&&document.activeElement.classList.contains("url-bar")||c.focus()}),document.addEventListener("keypress",function(e){13!=e.which&&c.focus()}),document.addEventListener("keydown",function(e){37!=e.which&&38!=e.which&&39!=e.which&&40!=e.which&&46!=e.which&&8!=e.which||c.focus()}),document.addEventListener("keydown",function(e){if(13==e.which&&(e.target.classList.contains("url-bar")||"BODY"==document.activeElement.nodeName)){if(13!=e.which)return;i.init(c.value,n)}}),document.addEventListener("click",function(e){e.target.classList.contains("format")&&(document.querySelector("button."+n).classList.remove("checked"),e.target.classList.add("checked"),n=e.target.attributes["data-format"].value,localStorage.setItem("lastFormat",n),i.init(c.value,n))}),document.addEventListener("click",function(e){e.target.classList.contains("go-back-on-click")&&fn.changeToView("format-selection")}),!!window.chrome&&!!window.chrome.webstore){var s=document.querySelector(".extension.chrome"),r=document.querySelector(".extension.chrome .extension-tooltip");s.querySelector(".svg").addEventListener("mouseenter",function(){r.classList.add("visible")}),s.addEventListener("mouseleave",function(){r.classList.remove("visible")}),document.addEventListener("click",function(e){e.target.classList.contains("chrome-icon")&&chrome.webstore.install("https://chrome.google.com/webstore/detail/ofojemljpdnbfmjenigkncgofkcoacag",function(e){console.log(e)},function(e){console.log(e)})}),s.classList.add("visible")}},function(e,t,o){"use strict";e.exports=function(e){function t(){for(var t;t=o.pop();)t.classList.remove(e);for(var n=document.activeElement;document.hasFocus()&&"#document"!=n.nodeName;)n.classList.add(e),o.push(n),n=n.parentNode}e||(e="focus-within");var o=[];document.addEventListener("focus",t,!0),document.addEventListener("blur",t,!0)}},function(e,t,o){"use strict";var n=o(3),i=(document.querySelector(".middle-container"),document.querySelector(".url input")),c=document.querySelector("a.dl-link");e.exports={},e.exports.init=function(e,t){if("loading-view"!=n.getCurrentView()){n.changeToView("loading-view");var o=new WebSocket("wss://apividl.kasp.io/website-dl");o.onclose=function(e){"loading-view"==n.getCurrentView()&&(console.log("ws err - The server connection closed unexpectedly."),console.log(e),n.showError(e.code,"The server connection closed unexpectedly."))},o.onopen=function(e){console.log("ws open"),console.log(e);var n={url:i.value,format:t};o.send(JSON.stringify(n))},o.onmessage=function(e){var t=JSON.parse(e.data),i=t.type;"err"==i?(console.log("vidl err - "+t.msg),console.log(t),n.showError(t.code,t.msg),o.close()):"info"==i?(console.log("info"),console.log(t),t.title&&n.showTitle(t.title),t.uploader&&n.showTitle(t.uploader)):"file"==i&&(console.log("file"),console.log(t),c.setAttribute("href","https://apividl.kasp.io/dl/"+t.id),c.click(),t.lastFile&&(n.changeToView("success-view"),o.close(),setTimeout(function(){n.changeToView("format-selection")},1e3)))}}}},function(e,t,o){"use strict";var n=document.querySelector(".middle-container"),i=n.querySelector(".loading-view .spacer"),c=n.querySelector("p.title"),s=n.querySelector("p.uploader"),r=n.querySelector("p.error-message"),l=n.querySelector("p.error-code"),a="format-selection",u=void 0,d={changeToView:function(e){clearTimeout(u),a=e;var t=n.attributes["data-view"].value;n.classList.remove(t),n.querySelector("."+t).classList.remove("visible"),u=setTimeout(function(){n.classList.add(e),n.setAttribute("data-view",e),n.querySelector("."+e).classList.add("visible"),d.updateMiddleContainerHeight()},70)},getCurrentView:function(){return a},showTitle:function(e){i.classList.add("visible"),c.classList.add("visible"),c.innerHTML=e,d.updateMiddleContainerHeight()},showUploader:function(e){i.classList.add("visible"),s.classList.add("visible"),s.innerHTML=e,d.updateMiddleContainerHeight()},hideTitle:function(e){i.classList.remove("visible"),c.classList.remove("visible")},hideUploader:function(){i.classList.remove("visible"),s.classList.remove("visible")},showError:function(e,t){d.changeToView("error-view"),r.innerHTML=t,l.innerHTML="Code: "+e},updateMiddleContainerHeight:function(){var e=document.querySelector(".middle-container > .visible").clientHeight;n.style.height=e+"px"}};d.updateMiddleContainerHeight(),window.fn=d,e.exports=d}]);